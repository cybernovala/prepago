...
<script>
  let rutGlobal = '';

  window.addEventListener('DOMContentLoaded', () => {
    const rutGuardado = localStorage.getItem('rut');
    if (rutGuardado) {
      document.getElementById('rutInput').value = rutGuardado;
    }
  });

  async function consultarRut() {
    const rut = document.getElementById('rutInput').value.trim();
    const resultadoDiv = document.getElementById('resultado');
    const errorDiv = document.getElementById('error');

    resultadoDiv.style.display = 'none';
    errorDiv.style.display = 'none';

    if (!rut) {
      errorDiv.textContent = 'Por favor ingresa un RUT.';
      errorDiv.style.display = 'block';
      return;
    }

    try {
      const response = await fetch('https://prepago.onrender.com/consultar', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ rut })
      });

      const data = await response.json();

      if (response.ok) {
        rutGlobal = rut;
        localStorage.setItem('rut', rut);

        document.getElementById('nombre').textContent = data.nombre;
        document.getElementById('saldo').textContent = data.saldo;
        resultadoDiv.style.display = 'block';

        document.getElementById('btnWhatsapp').onclick = () => {
          const mensaje = `Hola, soy ${data.nombre} (RUT: ${rutGlobal}). Quiero solicitar una impresi√≥n desde la app.`;
          const telefonoAdmin = '56966648585';
          const url = `https://wa.me/${telefonoAdmin}?text=${encodeURIComponent(mensaje)}`;
          window.open(url, '_blank');
        };

      } else {
        errorDiv.textContent = data.error || 'Error al consultar el RUT.';
        errorDiv.style.display = 'block';
      }

    } catch (error) {
      errorDiv.textContent = 'No se pudo conectar al servidor.';
      errorDiv.style.display = 'block';
    }
  }
</script>
...
